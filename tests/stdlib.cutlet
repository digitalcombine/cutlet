# Test the standard library.

# Remove the system library directory path
$library.path remove 0

import stdlib

#=============================================================================#
# Testing try catch throw

print "Test: try catch throw"

try {
  raise "I threw an error"
  return 1
} catch err {
  if {$err == "I threw an error"} then {
    print "I caught an error ->" $err
  } else {
    print "I caught an unexpected error ->" $err
    return 1
  }
}

try {
  local myvar = 10
  try {
    if {$myvar != 10} then {
      print "$myvar != 10"
      return 1
    }
  } catch err {
    print "Try in blocks failed, $err"
    return 1
  }
} catch err {
  print $err
  return 1
}

#=============================================================================#
# Testing while loops

print "Test: while"

global result = ""
while {$result <> "+++++"} do {
  global result = "${result}+"
}

if {$result <> "+++++"} then {
  print "\$result <> \"+++++\" ->  \"${result}\""
  return 1
}

global result = ""
while {$result <> "+++++"} {
  global result = "${result}+"
  if {$result == "++++"} {
    break
  }
}

if {$result <> "++++"} then {
  print "\$result <> \"++++\" ->  \"${result}\""
  return 1
}

global result = ""
while {$result < "+-+-+-++"} {
  global result = "${result}+"
  if {$result == "+-+-+-+"} {
    continue
  }
  global result = "${result}-"
}

if {$result <> "+-+-+-++-"} then {
  print "\$result <> \"+-+-+-++-\" ->  \"${result}\""
  return 1
}
